System.register(["./index-legacy-DEO5MG59.js","./index-legacy-CKdb1S0Y.js","./index-legacy-JriFgtA_.js","./index-legacy-D_GAN2QI.js","./user-legacy-6yGVhG1i.js","./route-block-legacy-wdPIt6g0.js"],(function(e,l){"use strict";var n,t,o,a,s,c,i,r,u,d,f,m,g,v,p,B,b,h,y,w,C,k,x,S,V,_,D,T,j,O,P,U,A,z,E,H,I,R,q,F,N,$,M,K,L;return{setters:[e=>{n=e.d,t=e.N,o=e.c,a=e.r,s=e.a3,c=e.Q,i=e.f,r=e.i,u=e.a4,d=e.a5,f=e.a6,m=e.V,g=e.R,v=e.a7,p=e.a,B=e.a8,b=e.$,h=e.a9,y=e.D,w=e.P,C=e.aa,k=e.M,x=e.B,S=e.n,V=e.ab,_=e.ac,D=e.ad,T=e.ae,j=e.af,O=e.ag,P=e.k,U=e.l,A=e.q,z=e.a2,E=e.x,H=e.z,I=e.ah,R=e.A},e=>{q=e.C},e=>{F=e.B,N=e.F},e=>{$=e.C,M=e.s},e=>{K=e.u},e=>{L=e.b}],execute:function(){const[l,Q]=o("action-bar"),G=Symbol(l),J={placeholder:Boolean,safeAreaInsetBottom:t};var W=n({name:l,props:J,setup(e,{slots:l}){const n=a(),t=s(n,Q),{linkChildren:o}=c(G);o();const r=()=>{var t;return i("div",{ref:n,class:[Q(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[null==(t=l.default)?void 0:t.call(l)])};return()=>e.placeholder?t(r):r()}});const X=r(W),[Y,Z]=o("action-bar-button"),ee=u({},v,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var le=n({name:Y,props:ee,setup(e,{slots:l}){const n=d(),{parent:t,index:o}=f(G),a=m((()=>{if(t){const e=t.children[o.value-1];return!(e&&"isButton"in e)}})),s=m((()=>{if(t){const e=t.children[o.value+1];return!(e&&"isButton"in e)}}));return g({isButton:!0}),()=>{const{type:t,icon:o,text:c,color:r,loading:u,disabled:d}=e;return i(F,{class:Z([t,{last:s.value,first:a.value}]),size:"large",type:t,icon:o,color:r,loading:u,disabled:d,onClick:n},{default:()=>[l.default?l.default():c]})}}});const ne=r(le),[te,oe,ae]=o("dialog"),se=u({},C,{title:String,theme:String,width:S,message:[String,Function],callback:Function,allowHtml:Boolean,className:x,transition:k("van-dialog-bounce"),messageAlign:String,closeOnPopstate:t,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:t,closeOnClickOverlay:Boolean,keyboardEnabled:t,destroyOnClose:Boolean}),ce=[...D,"transition","closeOnPopstate","destroyOnClose"];var ie=n({name:te,props:se,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:l,slots:n}){const t=a(),o=p({confirm:!1,cancel:!1}),s=e=>l("update:show",e),c=l=>{var n;s(!1),null==(n=e.callback)||n.call(e,l)},r=n=>()=>{e.show&&(l(n),e.beforeClose?(o[n]=!0,_(e.beforeClose,{args:[n],done(){c(n),o[n]=!1},canceled(){o[n]=!1}})):c(n))},u=r("cancel"),d=r("confirm"),f=B((n=>{var o,a;e.keyboardEnabled&&n.target===(null==(a=null==(o=t.value)?void 0:o.popupRef)?void 0:a.value)&&({Enter:e.showConfirmButton?d:V,Escape:e.showCancelButton?u:V}[n.key](),l("keydown",n))}),["enter","esc"]),m=()=>{const l=n.title?n.title():e.title;if(l)return i("div",{class:oe("header",{isolated:!e.message&&!n.default})},[l])},g=l=>{const{message:n,allowHtml:t,messageAlign:o}=e,a=oe("message",{"has-title":l,[o]:o}),s=T(n)?n():n;return t&&"string"==typeof s?i("div",{class:a,innerHTML:s},null):i("div",{class:a},[s])},v=()=>{if(n.default)return i("div",{class:oe("content")},[n.default()]);const{title:l,message:t,allowHtml:o}=e;if(t){const e=!(!l&&!n.title);return i("div",{key:o?1:0,class:oe("content",{isolated:!e})},[g(e)])}},C=()=>n.footer?n.footer():"round-button"===e.theme?i(X,{class:oe("footer")},{default:()=>[e.showCancelButton&&i(ne,{type:"warning",text:e.cancelButtonText||ae("cancel"),class:oe("cancel"),color:e.cancelButtonColor,loading:o.cancel,disabled:e.cancelButtonDisabled,onClick:u},null),e.showConfirmButton&&i(ne,{type:"danger",text:e.confirmButtonText||ae("confirm"),class:oe("confirm"),color:e.confirmButtonColor,loading:o.confirm,disabled:e.confirmButtonDisabled,onClick:d},null)]}):i("div",{class:[O,oe("footer")]},[e.showCancelButton&&i(F,{size:"large",text:e.cancelButtonText||ae("cancel"),class:oe("cancel"),style:{color:e.cancelButtonColor},loading:o.cancel,disabled:e.cancelButtonDisabled,onClick:u},null),e.showConfirmButton&&i(F,{size:"large",text:e.confirmButtonText||ae("confirm"),class:[oe("confirm"),{[j]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:o.confirm,disabled:e.confirmButtonDisabled,onClick:d},null)]);return()=>{const{width:l,title:n,theme:o,message:a,className:c}=e;return i(w,b({ref:t,role:"dialog",class:[oe([o]),c],style:{width:y(l)},tabindex:0,"aria-labelledby":n||a,onKeydown:f,"onUpdate:show":s},h(e,ce)),{default:()=>[m(),v(),C()]})}}});const re=r(ie),ue=e("default",n({__name:"index",setup(e){const l=K(),n=m((()=>l.userInfo)),t=m((()=>!!n.value.name)),o=m((()=>"生活不止眼前的苟且，还有诗和远方的田野")),s=a(!1),c=a(""),r=a(""),u=a("");function d(){t.value||I.push({name:"login",query:{redirect:"profile"}})}function f(){t.value?(c.value="",r.value=n.value.name||"",u.value="",s.value=!0):d()}async function g(){if(c.value&&r.value&&u.value)try{const e=await R.post("/change-user-info",{oldPassword:c.value,newUsername:r.value,newPassword:u.value});l.userInfo.name=e.username,M(e.message||"用户信息修改成功"),s.value=!1,e.needRelogin&&(M("用户信息已修改，请重新登录"),I.push({name:"login",query:{redirect:I.currentRoute.value.fullPath}}))}catch(e){M("请求失败，请稍后再试"),console.error(e)}else M("请填写完整信息")}async function v(){try{await l.logout(),M("注销成功"),I.push({name:"login"})}catch(e){M("注销失败，请稍后再试"),console.error(e)}}return(e,l)=>{const a=q,m=$,p=N,B=re;return U(),P("div",null,[i(m,{inset:!0},{default:A((()=>[i(a,{center:"","is-link":!z(t),onClick:d},{title:A((()=>[E("span",null,H(z(t)?`${z(n).name}`:e.$t("profile.login")),1)])),label:A((()=>[E("span",null,H(z(o)),1)])),_:1},8,["is-link"])])),_:1}),i(m,{inset:!0,class:"!mt-16"},{default:A((()=>[i(a,{title:"修改用户信息",icon:"setting-o","is-link":"",onClick:f},{icon:A((()=>l[4]||(l[4]=[E("div",{class:"i-carbon:settings text-gray-400 mr-5 self-center"},null,-1)]))),_:1}),i(a,{title:"注销登录","is-link":"",onClick:v},{icon:A((()=>l[5]||(l[5]=[E("div",{class:"i-carbon:logout text-gray-400 mr-5 self-center"},null,-1)]))),_:1})])),_:1}),i(B,{show:s.value,"onUpdate:show":l[3]||(l[3]=e=>s.value=e),title:"修改用户信息","show-cancel-button":"",onConfirm:g},{default:A((()=>[i(p,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=e=>r.value=e),label:"用户名",placeholder:"请输入新用户名"},null,8,["modelValue"]),i(p,{modelValue:c.value,"onUpdate:modelValue":l[1]||(l[1]=e=>c.value=e),label:"旧密码",placeholder:"请输入旧密码",type:"password"},null,8,["modelValue"]),i(p,{modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=e=>u.value=e),label:"新密码",placeholder:"请输入新密码",type:"password"},null,8,["modelValue"])])),_:1},8,["show"])])}}}));"function"==typeof L&&L(ue)}}}));
