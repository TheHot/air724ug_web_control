import{d as E,m as k,n as I,c as z,r as x,u as A,a as R,b as q,w as M,e as O,f as l,p as U,g as G,h as Y,i as j,j as J,o as X,k as V,l as v,q as f,s as b,t as N,F as K,v as Q,x as W,y as Z,z as ee,A as te,_ as se}from"./index-f35fkoae.js";import{C as ae,s as ne}from"./index-Bf3vEwwm.js";import{T as oe}from"./index-n0NYtD7i.js";import{L,C as le}from"./index-dYdQ2Z2E.js";import{b as C}from"./route-block-B_A1xBdJ.js";const[ce,_,ue]=z("pull-refresh"),P=50,ie=["pulling","loosing","success"],re={disabled:Boolean,modelValue:Boolean,headHeight:k(P),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:I,successDuration:k(500),animationDuration:k(300)};var de=E({name:ce,props:re,emits:["change","refresh","update:modelValue"],setup(s,{emit:d,slots:o}){let i;const p=x(),h=x(),c=A(p),t=R({status:"normal",distance:0,duration:0}),r=q(),T=()=>{if(s.headHeight!==P)return{height:"".concat(s.headHeight,"px")}},m=()=>t.status!=="loading"&&t.status!=="success"&&!s.disabled,y=e=>{const a=+(s.pullDistance||s.headHeight);return e>a&&(e<a*2?e=a+(e-a)/2:e=a*1.5+(e-a*2)/4),Math.round(e)},u=(e,a)=>{const g=+(s.pullDistance||s.headHeight);t.distance=e,a?t.status="loading":e===0?t.status="normal":e<g?t.status="pulling":t.status="loosing",d("change",{status:t.status,distance:e})},n=()=>{const{status:e}=t;return e==="normal"?"":s["".concat(e,"Text")]||ue(e)},S=()=>{const{status:e,distance:a}=t;if(o[e])return o[e]({distance:a});const g=[];return ie.includes(e)&&g.push(l("div",{class:_("text")},[n()])),e==="loading"&&g.push(l(L,{class:_("loading")},{default:n})),g},B=()=>{t.status="success",setTimeout(()=>{u(0)},+s.successDuration)},D=e=>{i=Y(c.value)===0,i&&(t.duration=0,r.start(e))},$=e=>{m()&&D(e)},F=e=>{if(m()){i||D(e);const{deltaY:a}=r;r.move(e),i&&a.value>=0&&r.isVertical()&&(U(e),u(y(a.value)))}},H=()=>{i&&r.deltaY.value&&m()&&(t.duration=+s.animationDuration,t.status==="loosing"?(u(+s.headHeight,!0),d("update:modelValue",!0),G(()=>d("refresh"))):u(0))};return M(()=>s.modelValue,e=>{t.duration=+s.animationDuration,e?u(+s.headHeight,!0):o.success||s.successText?B():u(0,!1)}),O("touchmove",F,{target:h}),()=>{var e;const a={transitionDuration:"".concat(t.duration,"ms"),transform:t.distance?"translate3d(0,".concat(t.distance,"px, 0)"):""};return l("div",{ref:p,class:_()},[l("div",{ref:h,class:_("track"),style:a,onTouchstartPassive:$,onTouchend:H,onTouchcancel:H},[l("div",{class:_("head"),style:T()},[S()]),(e=o.default)==null?void 0:e.call(o)])])}}});const fe=j(de),he={class:"device-list"},w=E({__name:"index",setup(s){const d=x([]),o=x(!1),i=J();function p(c){i.push({path:"/control",query:{device:JSON.stringify(c)}})}async function h(){o.value=!0;try{const c=await te.get("/userPool");d.value=c}catch(c){ne("获取设备列表失败"),console.error("获取设备列表失败:",c)}finally{o.value=!1}}return X(()=>{h()}),(c,t)=>{const r=L,T=le,m=oe,y=ae,u=fe;return v(),V("div",he,[l(u,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=n=>o.value=n),onRefresh:h},{default:f(()=>[l(y,{inset:!0},{default:f(()=>[o.value?(v(),b(T,{key:0,center:""},{title:f(()=>[l(r,{type:"spinner",size:"24px"},{default:f(()=>t[1]||(t[1]=[N(" 加载中... ")])),_:1,__:[1]})]),_:1})):(v(!0),V(K,{key:1},Q(d.value,n=>(v(),b(T,{key:n.imei,title:n.imei,label:"No: ".concat(n.phone||"未设置"),"is-link":"",onClick:S=>p(n)},{"right-icon":f(()=>[l(m,{type:n.connected?"success":"danger",size:"medium",round:"",class:"status-tag"},{default:f(()=>[W("span",{class:"status-dot",style:Z({background:n.connected?"#4ade80":"#f56c6c"})},null,4),N(" "+ee(n.connected?"ONLINE":"OFFLINE"),1)]),_:2},1032,["type"])]),_:2},1032,["title","label","onClick"]))),128))]),_:1})]),_:1},8,["modelValue"])])}}});typeof C=="function"&&C(w);const ve=se(w,[["__scopeId","data-v-c13d3e94"]]);export{ve as default};
